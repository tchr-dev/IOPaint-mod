Running: uv run pytest iopaint/tests/test_api_error_handling.py::TestBudgetLimitsValidation::test_update_budget_limits_negative_daily -v
---
============================= test session starts ==============================
platform darwin -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- /Users/ikovale/Dev/IOPaint-mod/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /Users/ikovale/Dev/IOPaint-mod
configfile: pyproject.toml
plugins: anyio-4.12.1, loguru-0.4.0
collecting ... collected 1 item

iopaint/tests/test_api_error_handling.py::TestBudgetLimitsValidation::test_update_budget_limits_negative_daily ERROR [100%]

==================================== ERRORS ====================================
_ ERROR at setup of TestBudgetLimitsValidation.test_update_budget_limits_negative_daily _

tmp_path = PosixPath('/private/var/folders/6c/p3d8vbkj14j3s24cbg1btls00000gn/T/pytest-of-ikovale/pytest-3/test_update_budget_limits_nega0')

    @pytest.fixture
    def test_client(tmp_path):
        """Create a test client with mocked dependencies."""
        api_config = _make_api_config(tmp_path)
        budget_config = _make_budget_config(tmp_path)
    
        # Create API instance with mocked components
>       api = Api(
            config=api_config,
            budget_config=budget_config,
            openai_config=OpenAIConfig(api_key="", base_url="https://api.test/v1"),
        )
E       TypeError: Api.__init__() got an unexpected keyword argument 'budget_config'

iopaint/tests/test_api_error_handling.py:80: TypeError
=============================== warnings summary ===============================
iopaint/schema.py:426
  /Users/ikovale/Dev/IOPaint-mod/iopaint/schema.py:426: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

iopaint/helper.py:2
  /Users/ikovale/Dev/IOPaint-mod/iopaint/helper.py:2: DeprecationWarning: 'imghdr' is deprecated and slated for removal in Python 3.13
    import imghdr

iopaint/storage/models.py:57
  /Users/ikovale/Dev/IOPaint-mod/iopaint/storage/models.py:57: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class GenerationJob(BaseModel):

iopaint/storage/models.py:85
  /Users/ikovale/Dev/IOPaint-mod/iopaint/storage/models.py:85: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ImageRecord(BaseModel):

iopaint/storage/models.py:106
  /Users/ikovale/Dev/IOPaint-mod/iopaint/storage/models.py:106: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class HistorySnapshot(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR iopaint/tests/test_api_error_handling.py::TestBudgetLimitsValidation::test_update_budget_limits_negative_daily
========================= 5 warnings, 1 error in 3.35s =========================
---
Command failed with status 1
