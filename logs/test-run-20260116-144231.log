Running: uv run pytest iopaint/tests/test_model.py -v
---
============================= test session starts ==============================
platform darwin -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- /Users/ikovale/Dev/IOPaint-mod/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /Users/ikovale/Dev/IOPaint-mod
configfile: pyproject.toml
plugins: anyio-4.12.1, loguru-0.4.0
collecting ... collected 60 items

iopaint/tests/test_model.py::test_lama[Original-cuda] SKIPPED (CUDA ...) [  1%]
iopaint/tests/test_model.py::test_lama[Original-mps] PASSED              [  3%]
iopaint/tests/test_model.py::test_lama[Original-cpu] PASSED              [  5%]
iopaint/tests/test_model.py::test_lama[Resize-cuda] SKIPPED (CUDA is...) [  6%]
iopaint/tests/test_model.py::test_lama[Resize-mps] PASSED                [  8%]
iopaint/tests/test_model.py::test_lama[Resize-cpu] PASSED                [ 10%]
iopaint/tests/test_model.py::test_lama[Crop-cuda] SKIPPED (CUDA is n...) [ 11%]
iopaint/tests/test_model.py::test_lama[Crop-mps] PASSED                  [ 13%]
iopaint/tests/test_model.py::test_lama[Crop-cpu] PASSED                  [ 15%]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cuda] SKIPPED (C...) [ 16%]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu] PASSED          [ 18%]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cuda] SKIPPED (CUD...) [ 20%]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu] PASSED            [ 21%]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cuda] SKIPPED (CUDA ...) [ 23%]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu] PASSED              [ 25%]
iopaint/tests/test_model.py::test_ldm[plms-Original-cuda] SKIPPED (C...) [ 26%]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu] PASSED          [ 28%]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cuda] SKIPPED (CUD...) [ 30%]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu] PASSED            [ 31%]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cuda] SKIPPED (CUDA ...) [ 33%]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu] PASSED              [ 35%]
iopaint/tests/test_model.py::test_zits[False-Original-cuda] SKIPPED      [ 36%]
iopaint/tests/test_model.py::test_zits[False-Original-cpu] PASSED        [ 38%]
iopaint/tests/test_model.py::test_zits[False-Resize-cuda] SKIPPED (C...) [ 40%]
iopaint/tests/test_model.py::test_zits[False-Resize-cpu] PASSED          [ 41%]
iopaint/tests/test_model.py::test_zits[False-Crop-cuda] SKIPPED (CUD...) [ 43%]
iopaint/tests/test_model.py::test_zits[False-Crop-cpu] PASSED            [ 45%]
iopaint/tests/test_model.py::test_zits[True-Original-cuda] SKIPPED (...) [ 46%]
iopaint/tests/test_model.py::test_zits[True-Original-cpu] PASSED         [ 48%]
iopaint/tests/test_model.py::test_zits[True-Resize-cuda] SKIPPED (CU...) [ 50%]
iopaint/tests/test_model.py::test_zits[True-Resize-cpu] PASSED           [ 51%]
iopaint/tests/test_model.py::test_zits[True-Crop-cuda] SKIPPED (CUDA...) [ 53%]
iopaint/tests/test_model.py::test_zits[True-Crop-cpu] PASSED             [ 55%]
iopaint/tests/test_model.py::test_mat[True-Original-cuda] SKIPPED (C...) [ 56%]
iopaint/tests/test_model.py::test_mat[True-Original-cpu] PASSED          [ 58%]
iopaint/tests/test_model.py::test_mat[False-Original-cuda] SKIPPED (...) [ 60%]
iopaint/tests/test_model.py::test_mat[False-Original-cpu] PASSED         [ 61%]
iopaint/tests/test_model.py::test_fcf[Original-cuda] SKIPPED (CUDA i...) [ 63%]
iopaint/tests/test_model.py::test_fcf[Original-cpu] PASSED               [ 65%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_NS-Original] PASSED      [ 66%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_NS-Resize] PASSED        [ 68%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_NS-Crop] PASSED          [ 70%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_TELEA-Original] PASSED   [ 71%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_TELEA-Resize] PASSED     [ 73%]
iopaint/tests/test_model.py::test_cv2[3-INPAINT_TELEA-Crop] PASSED       [ 75%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_NS-Original] PASSED     [ 76%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_NS-Resize] PASSED       [ 78%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_NS-Crop] PASSED         [ 80%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_TELEA-Original] PASSED  [ 81%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_TELEA-Resize] PASSED    [ 83%]
iopaint/tests/test_model.py::test_cv2[15-INPAINT_TELEA-Crop] PASSED      [ 85%]
iopaint/tests/test_model.py::test_manga[Original-cuda] SKIPPED (CUDA...) [ 86%]
iopaint/tests/test_model.py::test_manga[Original-cpu] PASSED             [ 88%]
iopaint/tests/test_model.py::test_manga[Resize-cuda] SKIPPED (CUDA i...) [ 90%]
iopaint/tests/test_model.py::test_manga[Resize-cpu] PASSED               [ 91%]
iopaint/tests/test_model.py::test_manga[Crop-cuda] SKIPPED (CUDA is ...) [ 93%]
iopaint/tests/test_model.py::test_manga[Crop-cpu] PASSED                 [ 95%]
iopaint/tests/test_model.py::test_mi_gan[Original-cuda] SKIPPED (CUD...) [ 96%]
iopaint/tests/test_model.py::test_mi_gan[Original-mps] PASSED            [ 98%]
iopaint/tests/test_model.py::test_mi_gan[Original-cpu] PASSED            [100%]

=============================== warnings summary ===============================
iopaint/schema.py:423
  /Users/ikovale/Dev/IOPaint-mod/iopaint/schema.py:423: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
    @model_validator(mode="after")

iopaint/helper.py:2
  /Users/ikovale/Dev/IOPaint-mod/iopaint/helper.py:2: DeprecationWarning: 'imghdr' is deprecated and slated for removal in Python 3.13
    import imghdr

iopaint/model/ldm.py:279
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ldm.py:279: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
    @torch.cuda.amp.autocast()

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:44: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    "sqrt_alphas_cumprod", to_torch(np.sqrt(alphas_cumprod.cpu()))

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:48: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    to_torch(np.sqrt(1.0 - alphas_cumprod.cpu())),

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:51: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    "log_one_minus_alphas_cumprod", to_torch(np.log(1.0 - alphas_cumprod.cpu()))

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:54: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    "sqrt_recip_alphas_cumprod", to_torch(np.sqrt(1.0 / alphas_cumprod.cpu()))

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:58: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    to_torch(np.sqrt(1.0 / alphas_cumprod.cpu() - 1)),

iopaint/tests/test_model.py: 12 warnings
  /Users/ikovale/Dev/IOPaint-mod/.venv/lib/python3.12/site-packages/torch/_tensor.py:1079: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    return self.reciprocal() * other

iopaint/tests/test_model.py: 12 warnings
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/utils.py:74: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    (1 - alphas_prev) / (1 - alphas) * (1 - alphas / alphas_prev)

iopaint/tests/test_model.py: 12 warnings
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/utils.py:73: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    sigmas = eta * np.sqrt(

iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Original-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[ddim-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/ddim_sampler.py:71: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer("ddim_sqrt_one_minus_alphas", np.sqrt(1.0 - ddim_alphas))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:32: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('sqrt_alphas_cumprod', to_torch(np.sqrt(alphas_cumprod.cpu())))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:33: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('sqrt_one_minus_alphas_cumprod', to_torch(np.sqrt(1. - alphas_cumprod.cpu())))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:34: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('log_one_minus_alphas_cumprod', to_torch(np.log(1. - alphas_cumprod.cpu())))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:35: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('sqrt_recip_alphas_cumprod', to_torch(np.sqrt(1. / alphas_cumprod.cpu())))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:36: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('sqrt_recipm1_alphas_cumprod', to_torch(np.sqrt(1. / alphas_cumprod.cpu() - 1)))

iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Original-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Resize-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
iopaint/tests/test_model.py::test_ldm[plms-Crop-cpu]
  /Users/ikovale/Dev/IOPaint-mod/iopaint/model/plms_sampler.py:45: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    self.register_buffer('ddim_sqrt_one_minus_alphas', np.sqrt(1. - ddim_alphas))

iopaint/tests/test_model.py::test_zits[True-Original-cpu]
  /Users/ikovale/Dev/IOPaint-mod/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1786: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/aten/src/ATen/native/TensorShape.cpp:4319.)
    return forward_call(*args, **kwargs)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========== 38 passed, 22 skipped, 112 warnings in 74.56s (0:01:14) ============
---
